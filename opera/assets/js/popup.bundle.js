import{u as P,r as _,j as e,I as f,c as x,a as K,b as q,E as c,i as D,m as F,d as B,e as U,g as V,f as H,R as w,h as Y,B as X,L as $,k as z,l as J,n as Z,o as ee,p as se,q as te}from"./Loader-DqDKbA-0.chunk.js";import{b as A,C as oe,S as re,K as ae}from"./background.bundle.js";import{C as G,Q as ne}from"./index-BtFWZ24X.chunk.js";/* empty css                   */function W(){return A.runtime.openOptionsPage()}function ie(){return A.tabs.create({active:!0,url:"History/history.html"})}function le(){return A.tabs.query({active:!0,lastFocusedWindow:!0})}const ce="_popupBody_1tcrv_1",pe="_icon_1tcrv_7",de="_qrIcon_1tcrv_12",ue="_copyIcon_1tcrv_17",me="_link_1tcrv_22",he="_errorMessage_1tcrv_36",ye="_qrCodeContainer_1tcrv_43",g={popupBody:ce,icon:pe,qrIcon:de,copyIcon:ue,link:me,errorMessage:he,qrCodeContainer:ye};function _e(){const[{error:a,message:n}]=P(),[m,p]=_.useState(!1),[i,h]=_.useState(!1);return _.useEffect(()=>{let y=null;return y=setTimeout(()=>{p(!1)},1300),()=>{y&&clearTimeout(y)}},[m]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:g.popupBody,children:a?e.jsx("p",{className:g.errorMessage,children:n}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:x(g.icon,g.qrIcon),name:"qrcode",onClick:()=>h(!i)}),m?e.jsx(f,{className:x(g.icon,g.copyIcon),name:"tick"}):e.jsx(G,{text:n,onCopy:()=>p(!0),children:e.jsx(f,{className:x(g.icon,g.copyIcon),name:"copy"})}),e.jsx(G,{text:n,onCopy:()=>p(!0),children:e.jsx("h1",{className:g.link,children:K(n)})})]})}),!a&&i&&e.jsx("div",{className:g.qrCodeContainer,children:e.jsx(ne,{size:128,value:n})})]})}const ge="_header_spily_1",fe="_logo_spily_9",xe="_actions_spily_14",Se="_styledIcon_spily_18",j={header:ge,logo:fe,actions:xe,styledIcon:Se};function be(){const[a,n]=q(),[m,p]=_.useState(!1),[i,h]=_.useState({error:null,message:c});async function y(){p(!0);const l={apikey:a.apikey,hostUrl:a.host.hostUrl},d=await F.send(oe,l);if(p(!1),d.error)h({error:!0,message:d.message}),await B({user:null});else{h({error:!1,message:"Fetching domains successful"});const{domains:u,email:s}=d.data;await B({user:{domains:u,email:s}})}n({type:U.RELOAD_EXTENSION_SETTINGS,payload:!a.reload}),setTimeout(()=>{h({error:null,message:c})},1e3)}const b=m?"spinner":!D(i.error)&&(i.error?"cross":"tick")||"refresh";return e.jsxs("header",{className:j.header,children:[e.jsx("div",{children:e.jsx("img",{className:j.logo,width:"32",height:"32",src:"../assets/logo.png",alt:"logo"})}),e.jsxs("div",{className:j.actions,children:[e.jsx(f,{onClick:y,name:b,title:"Refresh",className:x("icon",j.styledIcon)}),a.history&&e.jsx(f,{onClick:ie,name:"clock",className:x("icon",j.styledIcon),title:"History"}),e.jsx(f,{onClick:W,name:"settings",className:x("icon",j.styledIcon),title:"Settings"})]})]})}const je="_formContainer_1bpyo_1",we="_formGroup_1bpyo_12",Ee="_formGroupRelative_1bpyo_18",Te="_label_1bpyo_25",ve="_labelAbsolute_1bpyo_37",Ne="_selectWrapper_1bpyo_51",Ce="_select_1bpyo_51",Ie="_selectOption_1bpyo_74",ke="_input_1bpyo_78",Re="_inputError_1bpyo_100",Oe="_errorText_1bpyo_104",Ue="_passwordWrapper_1bpyo_115",Pe="_passwordToggle_1bpyo_119",qe="_passwordToggleIcon_1bpyo_129",De="_submitButton_1bpyo_141",Ae="_createIcon_1bpyo_171",r={formContainer:je,formGroup:we,formGroupRelative:Ee,label:Te,labelAbsolute:ve,selectWrapper:Ne,select:Ce,selectOption:Ie,input:ke,inputError:Re,errorText:Oe,passwordWrapper:Ue,passwordToggle:Pe,passwordToggleIcon:qe,submitButton:De,createIcon:Ae};var L=(a=>(a.DefaultDomainId="default",a))(L||{});function Be(){var T,v;const a=q()[0],n=P()[1],[m,p]=_.useState(!1),[i,h]=_.useState(!1),{domainOptions:y,host:{hostDomain:b}}=a,[l,d]=_.useState({domain:((v=(T=y.find(({id:o})=>o==="default"))==null?void 0:T.value)==null?void 0:v.trim())||c,customurl:"",password:""}),[u,s]=_.useState({}),S=!u.customurl&&!u.password&&!0;async function E(){h(!0);const o=await le(),t=V(o,"[0].url",null);if(!(!D(t)&&H(t))){h(!1),n({type:w.SET_REQUEST_STATUS,payload:{error:!0,message:"Not a valid URL"}});return}const O={apiBody:{apikey:a.apikey,target:t,...l.customurl.trim()!==c&&{customurl:l.customurl.trim()},...!Y(l.password)&&{password:l.password},reuse:!1,...l.domain.trim()!==c&&{domain:l.domain.trim()}},hostUrl:a.host.hostUrl},N=await F.send(re,O);if(h(!1),N.error)n({type:w.SET_REQUEST_STATUS,payload:{error:!0,message:N.message}});else{const{data:{link:Q}}=N;n({type:w.SET_REQUEST_STATUS,payload:{error:!1,message:Q}})}}function C(o){d(t=>({...t,customurl:o})),o.length>0&&o.length<3?s(t=>({...t,customurl:"Custom URL must be at-least 3 characters"})):s(t=>({...t,customurl:void 0}))}function I(o){d(t=>({...t,password:o})),o.length>0&&o.length<3?s(t=>({...t,password:"Password must be at-least 3 characters"})):s(t=>({...t,password:void 0}))}return e.jsxs("div",{className:r.formContainer,children:[e.jsxs("div",{className:r.formGroup,children:[e.jsx("label",{htmlFor:"domain",className:r.label,children:"Domain"}),e.jsx("div",{className:r.selectWrapper,children:e.jsx("select",{id:"domain",name:"domain",value:l.domain,onChange:o=>d(t=>({...t,domain:o.target.value})),disabled:i,className:r.select,children:y.map(({id:o,option:t,value:k,disabled:R=!1})=>e.jsx("option",{className:r.selectOption,value:k,disabled:R,children:t},o))})})]}),e.jsxs("div",{className:r.formGroupRelative,children:[e.jsx("label",{htmlFor:"customurl",className:r.labelAbsolute,children:e.jsxs("span",{children:[b,"/"]})}),e.jsx("input",{id:"customurl",name:"customurl",type:"text",value:l.customurl,onChange:o=>{C(o.target.value.trim())},disabled:i,spellCheck:"false",className:x(r.input,u.customurl&&r.inputError)}),e.jsx("span",{className:r.errorText,children:u.customurl})]}),e.jsxs("div",{className:r.formGroupRelative,children:[e.jsx("label",{htmlFor:"password",className:r.labelAbsolute,children:e.jsx("span",{children:"Password"})}),e.jsxs("div",{className:r.passwordWrapper,children:[e.jsx("div",{className:r.passwordToggle,children:e.jsx(f,{onClick:()=>{i||p(!m)},name:m?"eye":"eye-closed",className:r.passwordToggleIcon})}),e.jsx("input",{id:"password",name:"password",type:m?"text":"password",value:l.password,spellCheck:"false",onChange:o=>{I(o.target.value)},disabled:i,className:x(r.input,u.password&&r.inputError)})]}),e.jsx("span",{className:r.errorText,children:u.password})]}),e.jsx("button",{type:"submit",disabled:!S||i,onClick:E,className:r.submitButton,children:i?e.jsx(f,{className:r.createIcon,name:"spinner"}):e.jsx("span",{children:"Create"})})]})}const Ge="_popup_xelqh_1",Fe={popup:Ge};function He(){const[a,n]=q(),[m,p]=P(),{reload:i}=a;return _.useEffect(()=>{async function h(){var I,T,v;const{key:y=c,host:b=c,userOptions:l={autoCopy:!1,devMode:!1,keepHistory:!1,pwdForUrls:!1}}=await z(),d={};let u=!1;y.trim().length>0&&(d.apikey=y,u=!0),b.trim().length>0&&l.devMode&&(d.host=b,d.advanced=!0,u=!0),l.keepHistory&&(d.history=!0,u=!0),u&&await J(d);const{settings:s={}}=await Z();if(!Object.prototype.hasOwnProperty.call(s,"apikey")||s.apikey===c){p({type:w.SET_REQUEST_STATUS,payload:{error:!0,message:"Extension requires an API Key to work"}}),p({type:w.SET_LOADING,payload:!1}),setTimeout(()=>W(),1300);return}let S=ae;Object.prototype.hasOwnProperty.call(s,"advanced")&&s.advanced&&Object.prototype.hasOwnProperty.call(s,"host")&&((I=s.host)==null?void 0:I.trim().length)>0&&H(s.host)&&(S={hostDomain:s.host.replace("http://",c).replace("https://",c).replace("www.",c).split(/[/?#]/)[0]||c,hostUrl:s.host.endsWith("/")?s.host.slice(0,-1):s.host});let E=!1;Object.prototype.hasOwnProperty.call(s,"history")&&s.history&&(E=s.history);const C=[{id:c,option:"-- Choose Domain --",value:c,disabled:!0},{id:L.DefaultDomainId,option:S.hostDomain,value:S.hostUrl,disabled:!1}];if(Object.prototype.hasOwnProperty.call(s,"user")&&s.user){const{user:o}=s;let t=o.domains.map(({id:k,address:R,homepage:O,banned:N})=>({id:k,option:O,value:R,disabled:N}));t=C.concat(t),n({type:U.HYDRATE_EXTENSION_SETTINGS,payload:{apikey:(T=s.apikey)==null?void 0:T.trim(),domainOptions:t,host:S,history:E}})}else n({type:U.HYDRATE_EXTENSION_SETTINGS,payload:{apikey:(v=s.apikey)==null?void 0:v.trim(),domainOptions:C,host:S,history:E}});p({type:w.SET_LOADING,payload:!1})}h()},[i,n,p]),e.jsx(X,{children:e.jsx("div",{id:"popup",className:Fe.popup,children:m.loading?e.jsx($,{}):e.jsxs(e.Fragment,{children:[e.jsx(be,{}),!D(m.error)&&e.jsx(_e,{}),e.jsx(Be,{})]})})})}const M=document.getElementById("popup-root");if(!M)throw new Error("Could not find popup-root container");const We=ee.createRoot(M);We.render(e.jsx(_.StrictMode,{children:e.jsx(se,{children:e.jsx(te,{children:e.jsx(He,{})})})}));
